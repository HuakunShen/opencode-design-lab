# 2026-01-25

## 07:35 - Dynamic Command Registration for Design Lab

**Core Decision**: Add `config.command` support to register `/design-lab:design` and `/design-lab:review` commands dynamically from the plugin.

### Options Considered

- **Agent-only approach**: Rely solely on the `designer` agent understanding context from conversation history
- **Command with agent routing**: Register commands that route to `designer` agent with embedded workflow instructions
- **Command with full template**: Embed complete instructions so commands work without agent context

### Decision & Rationale

Chose command with agent routing (`agent: "designer"`) plus detailed templates. This solves the memory issue — when using `/design-lab:design <topic>`, the agent receives the full workflow instructions directly in the template, no prior context needed. User can invoke from any agent context.

Used `design-lab:` prefix to avoid conflicts with existing commands (e.g., `/review` already exists in OpenCode).

### Key Changes

- `src/commands/index.ts` (new): Command builders for `/design-lab:design` and `/design-lab:review`
  - `buildDesignCommand()`: Creates run directory, delegates to model subagents, writes design files
  - `buildReviewCommand()`: Finds latest run, reads designs, delegates reviews, summarizes scores
- `src/design-lab.ts`: Registers commands via `config.command` alongside existing agent registration

### Future Considerations

- Could add more commands (e.g., `/design-lab:summary` to re-summarize existing reviews)
- Template content is duplicated from agent prompts — could extract shared workflow descriptions
- No validation that `$input` is provided for `/design-lab:design` (relies on agent handling empty input gracefully)
